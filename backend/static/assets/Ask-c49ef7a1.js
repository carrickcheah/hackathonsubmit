import{r as s,bW as Ct,bM as Tt,bH as t,bX as kt}from"./vendor-173803c2.js";import{R as Te,G as _t,V as ke,u as F,L as It,U as yt,S as ft,Q as vt,a as wt,E as Ft,A as jt,b as S,c as Rt,d as Pt,H as r,e as At,f as Ot,r as h,T as Vt,g as Lt,h as Nt,i as Bt}from"./index-b66f6e63.js";import{b as o,c as Gt,s as Ut,D as Et,a as i,r as b}from"./fluentui-react-d4501a53.js";import"./fluentui-icons-f75d1284.js";const Mt="_askContainer_1rw8c_1",Qt="_askTopSection_1rw8c_8",Ht="_askBottomSection_1rw8c_15",Dt="_askTitle_1rw8c_25",qt="_askQuestionInput_1rw8c_31",zt="_askAnswerContainer_1rw8c_37",Wt="_askAnalysisPanel_1rw8c_44",Xt="_askSettingsSeparator_1rw8c_49",Jt="_settingsButton_1rw8c_55",Kt="_commandsContainer_1rw8c_61",Yt="_commandButton_1rw8c_68",l={askContainer:Mt,askTopSection:Qt,askBottomSection:Ht,askTitle:Dt,askQuestionInput:qt,askAnswerContainer:zt,askAnalysisPanel:Wt,askSettingsSeparator:Xt,settingsButton:Jt,commandsContainer:Kt,commandButton:Yt};function Zt(){const[j,g]=s.useState(!1),[x,_e]=s.useState(""),[R,$t]=s.useState(""),[P,es]=s.useState(""),[A,Ie]=s.useState(.3),[C,ye]=s.useState(null),[O,fe]=s.useState(0),[V,ve]=s.useState(0),[L,N]=s.useState(Te.Hybrid),[B,we]=s.useState(3),[T,G]=s.useState(!0),[U,Fe]=s.useState(!1),[u,je]=s.useState(!1),[E,Re]=s.useState(_t.TextAndImages),[k,Pe]=s.useState(""),[Ae,Oe]=s.useState(""),[Ve,Le]=s.useState([ke.Embedding,ke.ImageEmbedding]),[M,Ne]=s.useState(!1),[Q,Be]=s.useState(!1),[H,Ge]=s.useState(!1),[D,Ue]=s.useState(!1),[Ee,Me]=s.useState(!1),[Qe,He]=s.useState(!1),[De,qe]=s.useState(!1),[ze,We]=s.useState(!1),[Xe,Je]=s.useState(!1),[Ke,Ye]=s.useState(!1),Ze=s.useRef(new Audio).current,[$e,et]=s.useState(!1),_=s.useRef(""),[I,q]=s.useState(!1),[p,z]=s.useState(),[c,tt]=s.useState(),[st,W]=s.useState([]),at={speechUrls:st,setSpeechUrls:W,audio:Ze,isPlaying:$e,setIsPlaying:et},[X,J]=s.useState(),[m,d]=s.useState(void 0),K=F?Ct().instance:void 0,{loggedIn:y}=s.useContext(It),nt=async()=>{Lt().then(e=>{Ge(e.showGPT4VOptions),G(e.showSemanticRankerOption),Ue(e.showSemanticRankerOption),Me(e.showVectorOption),e.showVectorOption||N(Te.Text),He(e.showUserUpload),qe(e.showLanguagePicker),We(e.showSpeechInput),Je(e.showSpeechOutputBrowser),Ye(e.showSpeechOutputAzure)})};s.useEffect(()=>{nt()},[]);const f=async e=>{_.current=e,p&&z(void 0),q(!0),J(void 0),d(void 0);const n=K?await Nt(K):void 0;try{const w={messages:[{content:e,role:"user"}],context:{overrides:{prompt_template:x.length===0?void 0:x,prompt_template_prefix:R.length===0?void 0:R,prompt_template_suffix:P.length===0?void 0:P,exclude_category:k.length===0?void 0:k,top:B,temperature:A,minimum_reranker_score:O,minimum_search_score:V,retrieval_mode:L,semantic_ranker:T,semantic_captions:U,use_oid_security_filter:M,use_groups_security_filter:Q,vector_fields:Ve,use_gpt4v:u,gpt4v_input:E,language:Ce.language,...C!==null?{seed:C}:{}}},session_state:c?c.session_state:null},xt=await Bt(w,n);tt(xt),W([null])}catch(w){z(w)}finally{q(!1)}},lt=(e,n)=>{_e(n||"")},ot=(e,n)=>{Ie(parseFloat(n||"0"))},rt=(e,n)=>{ye(parseInt(n||""))},it=(e,n)=>{ve(parseFloat(n||"0"))},ct=(e,n)=>{fe(parseFloat(n||"0"))},dt=(e,n)=>{we(parseInt(n||"3"))},ut=(e,n)=>{G(!!n)},pt=(e,n)=>{Fe(!!n)},mt=(e,n)=>{Pe(n||"")},St=e=>{f(e),Oe(e)},ht=e=>{X===e&&m===S.CitationTab?d(void 0):(J(e),d(S.CitationTab))},v=e=>{d(m===e?void 0:e)},bt=(e,n)=>{Ne(!!n)},gt=(e,n)=>{Be(!!n)},Y=o("promptTemplate"),Z=o("promptTemplateField"),$=o("temperature"),ee=o("temperatureField"),te=o("seed"),se=o("seedField"),ae=o("searchScore"),ne=o("searchScoreField"),le=o("rerankerScore"),oe=o("rerankerScoreField"),re=o("retrieveCount"),ie=o("retrieveCountField"),ce=o("excludeCategory"),de=o("excludeCategoryField"),ue=o("semanticRanker"),pe=o("semanticRankerField"),me=o("semanticCaptions"),Se=o("semanticCaptionsField"),he=o("useOidSecurityFilter"),be=o("useOidSecurityFilterField"),ge=o("useGroupsSecurityFilter"),xe=o("useGroupsSecurityFilterField"),{t:a,i18n:Ce}=Tt();return t.jsxs("div",{className:l.askContainer,children:[t.jsx(kt,{children:t.jsx("title",{children:a("pageTitle")})}),t.jsxs("div",{className:l.askTopSection,children:[t.jsxs("div",{className:l.commandsContainer,children:[Qe&&t.jsx(yt,{className:l.commandButton,disabled:y}),t.jsx(ft,{className:l.commandButton,onClick:()=>g(!j)})]}),t.jsx("h1",{className:l.askTitle,children:a("askTitle")}),t.jsx("div",{className:l.askQuestionInput,children:t.jsx(vt,{placeholder:a("gpt4vExamples.placeholder"),disabled:I,initQuestion:Ae,onSend:e=>f(e),showSpeechInput:ze})})]}),t.jsxs("div",{className:l.askBottomSection,children:[I&&t.jsx(Gt,{label:a("generatingAnswer")}),!_.current&&t.jsxs("div",{className:l.askTopSection,children:[De&&t.jsx(wt,{onLanguageChange:e=>Ce.changeLanguage(e)}),t.jsx(Ft,{onExampleClicked:St,useGPT4V:u})]}),!I&&c&&!p&&t.jsx("div",{className:l.askAnswerContainer,children:t.jsx(jt,{answer:c,index:0,speechConfig:at,isStreaming:!1,onCitationClicked:e=>ht(e),onThoughtProcessClicked:()=>v(S.ThoughtProcessTab),onSupportingContentClicked:()=>v(S.SupportingContentTab),showSpeechOutputAzure:Ke,showSpeechOutputBrowser:Xe})}),p?t.jsx("div",{className:l.askAnswerContainer,children:t.jsx(Rt,{error:p.toString(),onRetry:()=>f(_.current)})}):null,m&&c&&t.jsx(Pt,{className:l.askAnalysisPanel,activeCitation:X,onActiveTabChanged:e=>v(e),citationHeight:"600px",answer:c,activeTab:m})]}),t.jsxs(Ut,{headerText:a("labels.headerText"),isOpen:j,isBlocking:!1,onDismiss:()=>g(!1),closeButtonAriaLabel:a("labels.closeButton"),onRenderFooterContent:()=>t.jsx(Et,{onClick:()=>g(!1),children:a("labels.closeButton")}),isFooterAtBottom:!0,children:[t.jsx(i,{id:Z,className:l.chatSettingsSeparator,defaultValue:x,label:a("labels.promptTemplate"),multiline:!0,autoAdjustHeight:!0,onChange:lt,"aria-labelledby":Y,onRenderLabel:e=>t.jsx(r,{labelId:Y,fieldId:Z,helpText:a("helpTexts.promptTemplate"),label:e?.label})}),t.jsx(i,{id:ee,className:l.chatSettingsSeparator,label:a("labels.temperature"),type:"number",min:0,max:1,step:.1,defaultValue:A.toString(),onChange:ot,"aria-labelledby":$,onRenderLabel:e=>t.jsx(r,{labelId:$,fieldId:ee,helpText:a("helpTexts.temperature"),label:e?.label})}),t.jsx(i,{id:se,className:l.chatSettingsSeparator,label:a("labels.seed"),type:"text",defaultValue:C?.toString()||"",onChange:rt,"aria-labelledby":te,onRenderLabel:e=>t.jsx(r,{labelId:te,fieldId:se,helpText:a("helpTexts.seed"),label:e?.label})}),t.jsx(i,{id:ne,className:l.chatSettingsSeparator,label:a("labels.minimumSearchScore"),type:"number",min:0,step:.01,defaultValue:V.toString(),onChange:it,"aria-labelledby":ae,onRenderLabel:e=>t.jsx(r,{labelId:ae,fieldId:ne,helpText:a("helpTexts.searchScore"),label:e?.label})}),D&&t.jsx(i,{id:oe,className:l.chatSettingsSeparator,label:a("labels.minimumRerankerScore"),type:"number",min:1,max:4,step:.1,defaultValue:O.toString(),onChange:ct,"aria-labelledby":le,onRenderLabel:e=>t.jsx(r,{labelId:le,fieldId:oe,helpText:a("helpTexts.rerankerScore"),label:e?.label})}),t.jsx(i,{id:ie,className:l.chatSettingsSeparator,label:a("labels.retrieveCount"),type:"number",min:1,max:50,defaultValue:B.toString(),onChange:dt,"aria-labelledby":re,onRenderLabel:e=>t.jsx(r,{labelId:re,fieldId:ie,helpText:a("helpTexts.retrieveNumber"),label:e?.label})}),t.jsx(i,{id:de,className:l.chatSettingsSeparator,label:a("labels.excludeCategory"),defaultValue:k,onChange:mt,"aria-labelledby":ce,onRenderLabel:e=>t.jsx(r,{labelId:ce,fieldId:de,helpText:a("helpTexts.excludeCategory"),label:e?.label})}),D&&t.jsxs(t.Fragment,{children:[t.jsx(b,{id:pe,className:l.chatSettingsSeparator,checked:T,label:a("labels.useSemanticRanker"),onChange:ut,"aria-labelledby":ue,onRenderLabel:e=>t.jsx(r,{labelId:ue,fieldId:pe,helpText:a("helpTexts.useSemanticReranker"),label:e?.label})}),t.jsx(b,{id:Se,className:l.chatSettingsSeparator,checked:U,label:a("labels.useSemanticCaptions"),onChange:pt,disabled:!T,"aria-labelledby":me,onRenderLabel:e=>t.jsx(r,{labelId:me,fieldId:Se,helpText:a("helpTexts.useSemanticCaptions"),label:e?.label})})]}),H&&t.jsx(At,{gpt4vInputs:E,isUseGPT4V:u,updateUseGPT4V:e=>{je(e)},updateGPT4VInputs:e=>Re(e)}),Ee&&t.jsx(Ot,{defaultRetrievalMode:L,showImageOptions:u&&H,updateVectorFields:e=>Le(e),updateRetrievalMode:e=>N(e)}),F&&t.jsxs(t.Fragment,{children:[t.jsx(b,{id:be,className:l.chatSettingsSeparator,checked:M||h,label:a("labels.useOidSecurityFilter"),disabled:!y||h,onChange:bt,"aria-labelledby":he,onRenderLabel:e=>t.jsx(r,{labelId:he,fieldId:be,helpText:a("helpTexts.useOidSecurityFilter"),label:e?.label})}),t.jsx(b,{id:xe,className:l.chatSettingsSeparator,checked:Q||h,label:a("labels.useGroupsSecurityFilter"),disabled:!y||h,onChange:gt,"aria-labelledby":ge,onRenderLabel:e=>t.jsx(r,{labelId:ge,fieldId:xe,helpText:a("helpTexts.useGroupsSecurityFilter"),label:e?.label})})]}),F&&t.jsx(Vt,{})]})]})}Zt.displayName="Ask";export{Zt as Component};
//# sourceMappingURL=Ask-c49ef7a1.js.map
